<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="alz.admin.mapper.AdminUserMapper">

	<!-- 이메일 중복 체크 -->
	<select id="emailChk" resultType="Integer">
		SELECT COUNT(*) FROM alz_user
		WHERE email = #{email}
	</select>

	<!-- 닉네임 중복 체크 -->
	<select id="nicknameChk" resultType="Integer">
		SELECT COUNT(*) FROM
		alz_user
		WHERE nickname = #{nickname}
	</select>

	<select id="selectByEmail" resultType="alz.user.domain.UserDTO">
		SELECT * FROM alz_user
		WHERE email = #{email}
	</select>

	<!-- 01. 회원목록 -->
	<select id="userList" resultType="alz.user.domain.UserDTO">
		SELECT
		email,
		nickname,
		PHONE_NUMBER AS phoneNumber
		FROM alz_user
		ORDER BY email
	</select>

	<!-- 02. 회원 등록 -->
	<insert id="insertUser" parameterType="alz.user.domain.UserDTO">
		<selectKey keyProperty="id" order="BEFORE" resultType="long">
			SELECT alz_user_seq.nextval FROM dual
		</selectKey>
		INSERT INTO ALZ_USER (ID, EMAIL, NICKNAME, PASSWORD, ROLE,
		PHONE_NUMBER)
		VALUES(#{id}, #{email}, #{nickname}, #{password},
		#{role}, #{phoneNumber})
	</insert>

	<!-- 03. 회원정보 상세조회 -->
	<select id="viewUser" resultType="alz.user.domain.UserDTO">
		SELECT
		email, nickname, role,
		certification_State certificationState, phone_Number
		phoneNumber
		FROM
		alz_user
		WHERE email = #{email}
	</select>

	<!-- 04. 회원정보 수정처리 -->
	<update id="updateUser">
		UPDATE alz_user
		SET password = #{password},
		nickname =
		#{nickname},
		PHONE_NUMBER = #{phoneNumber}
		WHERE email = #{email}
	</update>

	<!-- 05. 회원정보 삭제 처리 -->
	<delete id="deleteUser">
		DELETE FROM alz_user
		WHERE email = #{email}
	</delete>

	<!-- 06. 비밀번호 체크 -->
	<select id="checkPw" resultType="int">
		SELECT
		COUNT(*)
		FROM alz_user
		WHERE email = #{email} AND password = #{password}
	</select>

	<!-- 회원상태변경 -->
	<update id="admin_member_forced_evictionCheck"
		parameterType="alz.user.domain.UserDTO">
		update alz_user
		set enable = 0
		where email = #{email}
	</update>

	<!-- 회원 정보 찾기 관련 mapper -->
	<select id="member_info" resultType="alz.user.domain.UserDTO">
		select email, nickname,
		PHONE_NUMBER
		from alz_user
		where email=#{email}
	</select>
</mapper>